

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>brutus_red &mdash; brutus 0.3.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="brutus 0.3.1 documentation" href="../index.html"/>
        <link rel="up" title="Module code" href="index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> brutus
          

          
            
            <img src="../_static/brutus.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                0.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery.html">Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installing brutus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../running.html">Running brutus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../acknowledge.html">Acknowledging brutus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/modules.html">Functions</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">brutus</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">Module code</a> &raquo;</li>
      
    <li>brutus_red</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for brutus_red</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd"> brutus: a set of Python modules to process datacubes from integral field spectrographs.\n</span>
<span class="sd"> Copyright (C) 2016,  F.P.A. Vogt</span>
<span class="sd"> </span>
<span class="sd"> -----------------------------------------------------------------------------------------</span>
<span class="sd"> </span>
<span class="sd"> This file contains several function and tools used by the brutus routines to correct</span>
<span class="sd"> emission line fluxes for galactic and extragalactic reddening.</span>

<span class="sd"> Created April 2016, F.P.A. Vogt - frederic.vogt@alumni.anu.edu.au</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="c1"># ----------------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="kn">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">scipy.interpolate</span> <span class="kn">as</span> <span class="nn">interpolate</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.gridspec</span> <span class="kn">as</span> <span class="nn">gridspec</span>

<span class="kn">from</span> <span class="nn">brutus_metadata</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># ----------------------------------------------------------------------------------------      </span>

<div class="viewcode-block" id="D_fm90"><a class="viewcode-back" href="../modules/brutus_red.html#brutus_red.D_fm90">[docs]</a><span class="k">def</span> <span class="nf">D_fm90</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">gamma</span><span class="p">,</span><span class="n">x0</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; The UV points from Fitzpatrick &amp; Massa (1990). </span>
<span class="sd">    </span>
<span class="sd">    :Args:</span>
<span class="sd">        x: float</span>
<span class="sd">           Wavelength in 1/microns.</span>
<span class="sd">        gamma: float</span>
<span class="sd">               The gamma factor.</span>
<span class="sd">        x0: float</span>
<span class="sd">            The x0 factor.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">((</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="n">x0</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">gamma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span></div>
<span class="c1"># ---------------------------------------------------------------------------------------- </span>
     
<div class="viewcode-block" id="F_fm90"><a class="viewcode-back" href="../modules/brutus_red.html#brutus_red.F_fm90">[docs]</a><span class="k">def</span> <span class="nf">F_fm90</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;The UV points from Fitzpatrick &amp; Massa (1990). </span>
<span class="sd">        </span>
<span class="sd">    :Args:</span>
<span class="sd">        x: float</span>
<span class="sd">           Wavelength in 1/microns.</span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">item</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">item</span> <span class="o">&gt;=</span> <span class="mf">5.9</span><span class="p">:</span>    
            <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5392</span><span class="o">*</span><span class="p">(</span><span class="n">item</span><span class="o">-</span><span class="mf">5.9</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.05644</span><span class="o">*</span><span class="p">(</span><span class="n">item</span><span class="o">-</span><span class="mf">5.9</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">return</span> <span class="n">out</span></div>
<span class="c1"># ----------------------------------------------------------------------------------------  </span>
            
<div class="viewcode-block" id="f99_alebv"><a class="viewcode-back" href="../modules/brutus_red.html#brutus_red.f99_alebv">[docs]</a><span class="k">def</span> <span class="nf">f99_alebv</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="n">rv</span><span class="o">=</span><span class="mf">3.1</span><span class="p">):</span> <span class="c1"># lams in Angstroem</span>
    <span class="sd">&#39;&#39;&#39;The spline-interpolated Fitzpatrick, PASP (1999) Alambda/E(B-V) function.</span>
<span class="sd">    </span>
<span class="sd">    :Args: </span>
<span class="sd">        lams: 1-D numpy array of floats</span>
<span class="sd">              The wavelengths in Angstroem.</span>
<span class="sd">        rv: float [default: 3.1]</span>
<span class="sd">            The Rv value.</span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">my_lams</span> <span class="o">=</span> <span class="mf">1.0e4</span><span class="o">/</span><span class="n">lams</span> 
     
    <span class="c1"># Make sure this is an array, or the code will crash</span>
    <span class="k">try</span> <span class="p">:</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">my_lams</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">:</span>
        <span class="n">my_lams</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">my_lams</span><span class="p">])</span>
       
    <span class="c1"># First, the anchor points (in 1/lambda)</span>
    <span class="n">uv_anchors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">3.704</span><span class="p">,</span><span class="mf">3.846</span><span class="p">])</span>
    <span class="n">optical_anchors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.667</span><span class="p">,</span> <span class="mf">1.828</span><span class="p">,</span> <span class="mf">2.141</span><span class="p">,</span> <span class="mf">2.433</span><span class="p">])</span>
    <span class="n">ir_anchors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.377</span><span class="p">,</span> <span class="mf">0.820</span><span class="p">])</span>    
             
    <span class="c1"># ---- The parameters for the UV points ----</span>
    <span class="n">c2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.824</span> <span class="o">+</span> <span class="mf">4.717</span><span class="o">/</span><span class="n">rv</span>
    <span class="n">c1</span> <span class="o">=</span> <span class="mf">2.030</span> <span class="o">-</span> <span class="mf">3.007</span> <span class="o">*</span> <span class="n">c2</span>
    <span class="n">x0</span> <span class="o">=</span> <span class="mf">4.596</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.99</span>
    <span class="n">c3</span> <span class="o">=</span> <span class="mf">3.23</span>
    <span class="n">c4</span> <span class="o">=</span> <span class="mf">0.41</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">D_fm90</span><span class="p">(</span><span class="n">uv_anchors</span><span class="p">,</span><span class="n">gamma</span><span class="p">,</span><span class="n">x0</span><span class="p">)</span>
    <span class="n">F</span> <span class="o">=</span> <span class="n">F_fm90</span><span class="p">(</span><span class="n">uv_anchors</span><span class="p">)</span>    
    <span class="n">kx_V</span> <span class="o">=</span> <span class="n">c1</span> <span class="o">+</span> <span class="n">c2</span> <span class="o">*</span> <span class="n">uv_anchors</span> <span class="o">+</span> <span class="n">c3</span> <span class="o">*</span> <span class="n">D</span> <span class="o">+</span> <span class="n">c4</span> <span class="o">*</span> <span class="n">F</span>
    <span class="n">uv_spline</span> <span class="o">=</span> <span class="n">kx_V</span> <span class="o">+</span> <span class="n">rv</span>
    
    <span class="c1"># ---- For the optical anchors ----</span>
    <span class="n">optical_spline</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">optical_anchors</span><span class="p">)</span>
    <span class="n">optical_spline</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.426</span> <span class="o">+</span> <span class="mf">1.0044</span> <span class="o">*</span> <span class="n">rv</span>
    <span class="n">optical_spline</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.050</span> <span class="o">+</span> <span class="mf">1.0016</span> <span class="o">*</span> <span class="n">rv</span>
    <span class="n">optical_spline</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.701</span> <span class="o">+</span> <span class="mf">1.0016</span> <span class="o">*</span> <span class="n">rv</span> 
    <span class="n">optical_spline</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="o">+</span><span class="mf">1.208</span> <span class="o">+</span> <span class="mf">1.0032</span> <span class="o">*</span> <span class="n">rv</span> <span class="o">-</span> <span class="mf">0.00033</span> <span class="o">*</span> <span class="n">rv</span><span class="o">**</span><span class="mi">2</span> 
    <span class="c1"># WARNING : typo in F99 ?</span>
    <span class="c1"># See their Table 4 ... with &#39;-1.208&#39;, it doesn&#39;t work !</span>

    <span class="c1"># ---- For the IR anchors ----</span>
    <span class="n">ir_spline</span> <span class="o">=</span> <span class="n">rv</span><span class="o">/</span><span class="mf">3.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.265</span><span class="p">,</span><span class="mf">0.829</span><span class="p">])</span>
    
    <span class="c1"># Ok, now, perform the spline interpolation</span>
    <span class="n">wave</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ir_anchors</span><span class="p">,</span> <span class="n">optical_anchors</span><span class="p">),</span> <span class="n">uv_anchors</span><span class="p">)</span>
    <span class="n">alebv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ir_spline</span><span class="p">,</span> <span class="n">optical_spline</span><span class="p">),</span> <span class="n">uv_spline</span><span class="p">)</span>   
    <span class="n">interp_func</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">wave</span><span class="p">,</span> <span class="n">alebv</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">,</span> 
                                       <span class="n">bounds_error</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span> 
    <span class="c1"># bounds_error = False -&gt; Will return a NaN is outside the allowed range </span>
    
    <span class="c1"># Finally, compute the value at the wavelengths of interest</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">my_lams</span><span class="p">)</span>
    
    <span class="c1"># If lam &gt; 2700, use the spline function</span>
    <span class="n">out</span><span class="p">[</span><span class="n">lams</span><span class="o">&gt;</span><span class="mi">2700</span><span class="p">]</span> <span class="o">=</span> <span class="n">interp_func</span><span class="p">(</span><span class="n">my_lams</span><span class="p">[</span><span class="n">lams</span><span class="o">&gt;</span><span class="mi">2700</span><span class="p">])</span>
    <span class="c1"># If lam &lt;= 2700, use the fm90 function</span>
    <span class="n">Dl</span> <span class="o">=</span> <span class="n">D_fm90</span><span class="p">(</span><span class="n">my_lams</span><span class="p">[</span><span class="n">lams</span><span class="o">&lt;=</span><span class="mi">2700</span><span class="p">],</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>
    <span class="n">Fl</span> <span class="o">=</span> <span class="n">F_fm90</span><span class="p">(</span><span class="n">my_lams</span><span class="p">[</span><span class="n">lams</span><span class="o">&lt;=</span><span class="mi">2700</span><span class="p">])</span>
    <span class="n">out</span><span class="p">[</span><span class="n">lams</span><span class="o">&lt;=</span><span class="mi">2700</span><span class="p">]</span> <span class="o">=</span> <span class="n">rv</span> <span class="o">+</span> <span class="n">c1</span> <span class="o">+</span> <span class="n">c2</span> <span class="o">*</span> <span class="n">my_lams</span><span class="p">[</span><span class="n">lams</span><span class="o">&lt;=</span><span class="mi">2700</span><span class="p">]</span> <span class="o">+</span> <span class="n">c3</span> <span class="o">*</span> <span class="n">Dl</span> <span class="o">+</span> <span class="n">c4</span> <span class="o">*</span> <span class="n">Fl</span>
    
    <span class="k">return</span> <span class="n">out</span>  </div>
<span class="c1"># ----------------------------------------------------------------------------------------  </span>
<span class="c1"># Get E_lambda-V/E_B-V following Fischera &amp; Dopita05. Unlike Vogt et al. (2013), follow </span>
<span class="c1"># the paper more closely, and allow for varying values of Rv using polynomials given in </span>
<span class="c1"># the text. In other words, use BOTH rv and rva to characterize the attenuation curve.</span>
<div class="viewcode-block" id="fd05_elvebv"><a class="viewcode-back" href="../modules/brutus_red.html#brutus_red.fd05_elvebv">[docs]</a><span class="k">def</span> <span class="nf">fd05_elvebv</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span> <span class="n">rv</span> <span class="o">=</span> <span class="mf">3.08</span><span class="p">,</span> <span class="n">rva</span> <span class="o">=</span> <span class="mf">4.3</span><span class="p">):</span> <span class="c1"># lams in Angstroem</span>
    <span class="sd">&#39;&#39;&#39;Compute E(lambda-V)/E(B-V) according to Fischera&amp;Dopita (2005), given Rv and Rva.</span>
<span class="sd">    </span>
<span class="sd">    This function reproduces Table 1 in the article. Unlike in Appendix 1 of Vogt et al.</span>
<span class="sd">    (2013), this function relies on the polynomials defined in the text to reproduce the </span>
<span class="sd">    values of E(lambda-V)/E(B-V) for any Rv and Rva.</span>
<span class="sd">    </span>
<span class="sd">    :Args: </span>
<span class="sd">        lams: 1-D numpy array of float</span>
<span class="sd">              The wavelengths at which to evaluate the attenutation.</span>
<span class="sd">        rv: float [default: 3.08]</span>
<span class="sd">            The Rv value, following Fischera &amp; Dopita.</span>
<span class="sd">        rva: float [default: 4.5]</span>
<span class="sd">             The Rva value, following Fischera &amp; Dopita.</span>
<span class="sd">    </span>
<span class="sd">    :Returns:</span>
<span class="sd">        out: 1-D numpy aarray of float</span>
<span class="sd">             The value of E(lambda-V)/E(B-V), as in Table 1 and Fig.3 of the article.</span>
<span class="sd">             </span>
<span class="sd">    :Notes:</span>
<span class="sd">        By default, Rv = 3.08 and Rva = 4.3, which gives a curve vey close to that of </span>
<span class="sd">        Calzetti (2000) below the 2000 Ansgtroem bump. Thanks to R. Sutherland at ANU/RSAA</span>
<span class="sd">        for sharing his reddening code (included in MAPPINGS V), which helped me implement </span>
<span class="sd">        this function properly.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="c1"># Make sure this is an array (for the overall consistency)</span>
    <span class="k">try</span> <span class="p">:</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">lams</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">:</span>
        <span class="n">lams</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">lams</span><span class="p">])</span>
        
    <span class="c1"># Rv &lt; 3.08 is probably a bad thing ...    </span>
    <span class="k">if</span> <span class="n">rv</span> <span class="o">&lt;</span> <span class="mf">3.08</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot; Rv &lt;3.08 not supported !&quot;</span><span class="p">)</span>
    
    <span class="c1"># The wavelength nodes from Table 1 in microns</span>
    <span class="n">lam_nodes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0912</span><span class="p">,</span> <span class="mf">0.1053</span><span class="p">,</span> <span class="mf">0.1216</span><span class="p">,</span> <span class="mf">0.1550</span><span class="p">,</span> <span class="mf">0.1906</span><span class="p">,</span> <span class="mf">0.2175</span><span class="p">,</span> <span class="mf">0.2480</span><span class="p">,</span> <span class="mf">0.3000</span><span class="p">,</span>
                          <span class="mf">0.3650</span><span class="p">,</span> <span class="mf">0.4400</span><span class="p">,</span> <span class="mf">0.5480</span><span class="p">,</span> <span class="mf">0.7200</span><span class="p">,</span> <span class="mf">1.0300</span><span class="p">,</span> <span class="mf">1.2390</span><span class="p">,</span> <span class="mf">1.6490</span><span class="p">,</span> <span class="mf">2.1920</span><span class="p">,</span>
                          <span class="mf">3.5920</span><span class="p">,</span> <span class="mf">4.7770</span><span class="p">])</span>
    
    <span class="c1"># Do it all for the Av=1 curves. According to the paper:</span>
    <span class="c1">#  If the approximation obtained for AV= 1 is used for a turbulent medium where </span>
    <span class="c1"># AV= 10 the accuracy is better than ∼5%.</span>
    
    <span class="c1"># The curve for Rv=Rva=3.08</span>
    <span class="n">elv_ebv308a1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">12.066</span><span class="p">,</span> <span class="mf">9.694</span><span class="p">,</span> <span class="mf">7.328</span><span class="p">,</span> <span class="mf">5.018</span><span class="p">,</span> <span class="mf">5.214</span><span class="p">,</span> <span class="mf">6.937</span><span class="p">,</span> <span class="mf">4.573</span><span class="p">,</span> <span class="mf">2.967</span><span class="p">,</span> 
                             <span class="mf">1.924</span><span class="p">,</span> <span class="mf">1.000</span><span class="p">,</span> <span class="mf">0.000</span><span class="p">,</span><span class="o">-</span><span class="mf">0.991</span><span class="p">,</span><span class="o">-</span><span class="mf">1.871</span><span class="p">,</span><span class="o">-</span><span class="mf">2.171</span><span class="p">,</span><span class="o">-</span><span class="mf">2.498</span><span class="p">,</span><span class="o">-</span><span class="mf">2.716</span><span class="p">,</span>
                             <span class="o">-</span><span class="mf">2.932</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.992</span><span class="p">])</span>
                              
    <span class="c1"># The x from Eqt. 8. Al/Av = (Elv/Ebv*1/Rv) + 1</span>
    <span class="n">xs</span> <span class="o">=</span> <span class="n">elv_ebv308a1</span><span class="o">/</span><span class="mf">3.08</span> <span class="o">+</span> <span class="mf">1.0</span>
    
    <span class="c1"># The a coefficients, as polynomial using the b coefficients from Table 2.</span>
    <span class="n">fa1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.64220</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.62163</span><span class="p">,</span> <span class="mf">3.42939</span><span class="p">,</span> <span class="mf">0.00495676</span><span class="p">])</span>
    <span class="n">fa2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">([</span><span class="o">-</span><span class="mf">2.199</span><span class="p">,</span> <span class="mf">5.11725</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.668874</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.708645</span><span class="p">,</span> <span class="mf">0.0393932</span><span class="p">])</span>
    <span class="n">fa3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">([</span><span class="mf">21.5465</span><span class="p">,</span> <span class="o">-</span><span class="mf">19.2137</span><span class="p">,</span> <span class="mf">5.17489</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.484444</span><span class="p">,</span> <span class="mf">0.0174931</span><span class="p">])</span>
    
    <span class="c1"># By definition, following Par.2 in Sec 3.1.:</span>
    <span class="n">alphav</span> <span class="o">=</span> <span class="mf">3.08</span> 
    
    <span class="c1"># Eqt. 11</span>
    <span class="n">m</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mf">0.275</span> <span class="o">*</span> <span class="p">(</span><span class="n">rv</span> <span class="o">-</span> <span class="n">alphav</span><span class="p">)</span>
    
    <span class="c1"># Eqt. 10</span>
    <span class="n">alphava</span> <span class="o">=</span> <span class="n">m</span><span class="o">**-</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="n">rva</span> <span class="o">-</span> <span class="n">rv</span><span class="p">)</span> <span class="o">+</span> <span class="n">alphav</span>
    
    <span class="c1"># Eqt. 9</span>
    <span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">alphava</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span><span class="o">**-</span><span class="mi">1</span>
    <span class="n">a1</span> <span class="o">=</span> <span class="n">fa1</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="n">a2</span> <span class="o">=</span> <span class="n">fa2</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="n">a3</span> <span class="o">=</span> <span class="n">fa3</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    
    <span class="c1"># Eqt. 8</span>
    <span class="n">alav</span> <span class="o">=</span> <span class="n">a1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
    <span class="n">alav</span> <span class="o">+=</span> <span class="n">a2</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">xs</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">alav</span> <span class="o">+=</span> <span class="n">a3</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">xs</span><span class="p">))</span><span class="o">**</span><span class="mi">3</span>
    <span class="n">alav</span> <span class="o">=</span> <span class="mf">10.</span><span class="o">**</span><span class="n">alav</span>
    
    <span class="c1"># Reproduce the values of table 1. These are approximated using the polynomials, and </span>
    <span class="c1"># according to the article (for the table, set rv=3.08 and rva =...):</span>
    <span class="c1"># If applied to situations where the absolute attenuation AV is either 1 or 10, the </span>
    <span class="c1"># approximations are better than 1.3%.  In general the accuracy is somewhat lower.  </span>
    <span class="c1"># If the approximation obtained for AV= 1 is used for a turbulent medium where AV= 10 </span>
    <span class="c1"># the accuracy is better than ∼5%. The largest errors occurs at low optical depths. </span>
    <span class="c1"># For x≥1 the approximation is better than ∼2%.</span>
    <span class="n">elbebv</span> <span class="o">=</span> <span class="p">(</span><span class="n">alav</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span> <span class="o">*</span> <span class="n">rva</span>
    
    <span class="c1"># Very well, now, I need to interpolate between these nodes, to get a smooth function </span>
    <span class="c1"># at &quot;any&quot; wavelength. Use Akima splines. Fit the curve in 1/lam space, because the</span>
    <span class="c1"># points are a lot smoother then. Reverse their order, because x must be strictly </span>
    <span class="c1"># ascending. To be clear, this fits elb_ebv as a function of 1/lambda in 1/microns</span>
    <span class="n">akima_spline</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">Akima1DInterpolator</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="n">lam_nodes</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">elbebv</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> 
    
    <span class="k">return</span> <span class="n">akima_spline</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="n">lams</span><span class="o">*</span><span class="mf">1e-4</span><span class="p">))</span></div>
<span class="c1"># ----------------------------------------------------------------------------------------  </span>

<div class="viewcode-block" id="cal00_ke"><a class="viewcode-back" href="../modules/brutus_red.html#brutus_red.cal00_ke">[docs]</a><span class="k">def</span> <span class="nf">cal00_ke</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="n">rv</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;The Calzetti (2000) law. lams in Angstroem. </span>
<span class="sd">    </span>
<span class="sd">    :Notes:</span>
<span class="sd">        This does NOT include the 0.44 correction factor to apply for stellar extinction.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="c1"># Make sure lams is an array (for the overall consistency)</span>
    <span class="k">try</span> <span class="p">:</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">lams</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">:</span>
        <span class="n">lams</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">lams</span><span class="p">])</span>
    
    <span class="n">my_lams</span> <span class="o">=</span> <span class="mf">1.0e4</span><span class="o">/</span><span class="n">lams</span>             
    <span class="n">ke</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lams</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">lams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="mf">1.0e4</span> <span class="o">&lt;</span> <span class="mf">0.63</span> <span class="ow">and</span> <span class="n">lams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="mf">1.0e4</span> <span class="o">&gt;=</span> <span class="mf">0.12</span> <span class="p">:</span>
            <span class="n">ke</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.659</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">2.156</span> <span class="o">+</span><span class="mf">1.509</span> <span class="o">*</span> <span class="n">my_lams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.198</span><span class="o">*</span><span class="n">my_lams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                             <span class="mf">0.011</span> <span class="o">*</span> <span class="n">my_lams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">rv</span>
        <span class="k">elif</span> <span class="n">lams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="mf">1.0e4</span> <span class="o">&lt;</span> <span class="mf">2.20</span> <span class="ow">and</span> <span class="n">lams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="mf">1.0e4</span> <span class="o">&gt;=</span> <span class="mf">0.63</span> <span class="p">:</span>
            <span class="n">ke</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.659</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.857</span> <span class="o">+</span><span class="mf">1.040</span> <span class="o">*</span><span class="n">my_lams</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="n">rv</span>
    <span class="k">return</span> <span class="n">ke</span> </div>
<span class="c1"># ---------------------------------------------------------------------------------------- </span>

<span class="c1"># Following Cardelli, Clayton &amp; Mathis (1989)</span>
<div class="viewcode-block" id="ccm89_alav"><a class="viewcode-back" href="../modules/brutus_red.html#brutus_red.ccm89_alav">[docs]</a><span class="k">def</span> <span class="nf">ccm89_alav</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span> <span class="n">rv</span><span class="p">):</span> <span class="c1"># lams in Angstroem</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    The law from Caredelli, Clayton and Mathis (1989). lams in Angstroem.</span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="c1"># Make sure lams is an array </span>
    <span class="k">try</span> <span class="p">:</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">lams</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">:</span>
        <span class="n">lams</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">lams</span><span class="p">])</span>

    <span class="n">my_lams</span> <span class="o">=</span> <span class="mf">1.0e4</span><span class="o">/</span><span class="n">lams</span>
    
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
    <span class="n">alav</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">my_lams</span><span class="p">)):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">my_lams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="mf">0.3</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mf">1.1</span> <span class="p">:</span>
            <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.574</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mf">1.61</span>
            <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.527</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mf">1.61</span>
        <span class="k">elif</span> <span class="mf">1.1</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mf">3.3</span> <span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">-</span><span class="mf">1.82</span>
            <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">+</span> <span class="mf">0.17699</span> <span class="o">*</span> <span class="n">y</span> <span class="o">-</span><span class="mf">0.50447</span> <span class="o">*</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">0.02427</span> <span class="o">*</span> <span class="n">y</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>\
                <span class="mf">0.72085</span> <span class="o">*</span> <span class="n">y</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mf">0.01979</span> <span class="o">*</span> <span class="n">y</span><span class="o">**</span><span class="mi">5</span> <span class="o">-</span> <span class="mf">0.77530</span> <span class="o">*</span> <span class="n">y</span><span class="o">**</span><span class="mi">6</span> <span class="o">+</span> <span class="mf">0.32999</span> <span class="o">*</span> <span class="n">y</span><span class="o">**</span><span class="mi">7</span>
            <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.41338</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="mf">2.28305</span> <span class="o">*</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">1.07233</span> <span class="o">*</span> <span class="n">y</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mf">5.38434</span> <span class="o">*</span> <span class="n">y</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span>\
                <span class="mf">0.62251</span> <span class="o">*</span> <span class="n">y</span><span class="o">**</span><span class="mi">5</span> <span class="o">+</span> <span class="mf">5.30260</span> <span class="o">*</span> <span class="n">y</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mf">2.09002</span> <span class="o">*</span> <span class="n">y</span><span class="o">**</span><span class="mi">7</span>
        <span class="k">elif</span> <span class="mf">3.3</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;=</span> <span class="mi">8</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mf">5.9</span> <span class="p">:</span> 
                <span class="n">fa</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">fb</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="n">fa</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.04473</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mf">5.9</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">0.009779</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mf">5.9</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span>
                <span class="n">fb</span> <span class="o">=</span>  <span class="mf">0.2130</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mf">5.9</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.1207</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mf">5.9</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span>
            <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">1.752</span> <span class="o">-</span> <span class="mf">0.316</span> <span class="o">*</span> <span class="n">x</span> <span class="o">-</span> <span class="mf">0.104</span><span class="o">/</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="mf">4.67</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.341</span><span class="p">)</span> <span class="o">+</span> <span class="n">fa</span>
            <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.090</span> <span class="o">+</span> <span class="mf">1.825</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">1.206</span><span class="o">/</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="mf">4.62</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.263</span><span class="p">)</span> <span class="o">+</span> <span class="n">fb</span>
    
    <span class="n">alav</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="o">/</span><span class="n">rv</span>

    <span class="k">return</span> <span class="n">alav</span></div>
<span class="c1"># ---------------------------------------------------------------------------------------- </span>

<div class="viewcode-block" id="alam"><a class="viewcode-back" href="../modules/brutus_red.html#brutus_red.alam">[docs]</a><span class="k">def</span> <span class="nf">alam</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span> <span class="n">ab</span><span class="p">,</span> <span class="n">av</span><span class="p">,</span> <span class="n">curve</span><span class="o">=</span><span class="s1">&#39;f99&#39;</span><span class="p">,</span> <span class="n">rv</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">rva</span><span class="o">=</span><span class="mf">4.5</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Calculate the value of A_lambda for different extinction/attenuation laws.</span>
<span class="sd">    </span>
<span class="sd">    :Args:</span>
<span class="sd">        lams: 1-D numpy array of float</span>
<span class="sd">              The values at which to evaluate the attenuation/extinction.</span>
<span class="sd">        ab: float</span>
<span class="sd">            The extinction in B (e.g. according to NED)</span>
<span class="sd">        av: float</span>
<span class="sd">            The extinction in V (e.g. according to NED) </span>
<span class="sd">        curve: string [default: &#39;f99&#39;]</span>
<span class="sd">               Which extinction/attenuation curve to use.</span>
<span class="sd">        rv: float</span>
<span class="sd">            The value of Rv.</span>
<span class="sd">        rva: float [default: 4.5]</span>
<span class="sd">            The value of Rva, if using curve=&#39;fd05&#39;.</span>
<span class="sd">        </span>
<span class="sd">    :Notes: </span>
<span class="sd">        To reproduce the values given in NED, set curve=&#39;f99&#39;, and rv = 3.1. The default </span>
<span class="sd">        value of Rv will depend on the curve used (if not specified). rv=3.1 for &#39;f99&#39;, </span>
<span class="sd">        rv=3.08 for &#39;fd05&#39;, rv=4.05 for &#39;cal00&#39; and &#39;cal00*&#39;, and rv=3.1 for &#39;ccm89&#39;. </span>
<span class="sd">        &#39;cal00*&#39; includes a 0.44 correction factor to derive the stellar extinction.  </span>
<span class="sd">        </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">curve</span> <span class="o">==</span> <span class="s1">&#39;f99&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">rv</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">rv</span> <span class="o">=</span> <span class="mf">3.1</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">f99_alebv</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="n">rv</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">ab</span><span class="o">-</span><span class="n">av</span><span class="p">)</span> 
        <span class="k">return</span> <span class="n">out</span>
        
    <span class="k">if</span> <span class="n">curve</span> <span class="o">==</span> <span class="s1">&#39;fd05&#39;</span><span class="p">:</span>
        <span class="c1"># From Fischera&amp; Dopita (2005), see also Vogt et al. (2013).</span>
        <span class="k">if</span> <span class="n">rv</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">rv</span> <span class="o">=</span> <span class="mf">3.08</span>   
        <span class="n">red</span> <span class="o">=</span> <span class="n">fd05_elvebv</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span> <span class="n">rv</span><span class="o">=</span><span class="n">rv</span><span class="p">,</span> <span class="n">rva</span><span class="o">=</span><span class="n">rva</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">red</span> <span class="o">+</span> <span class="n">rva</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">ab</span><span class="o">-</span><span class="n">av</span><span class="p">)</span>
        
    <span class="k">elif</span> <span class="s1">&#39;cal00&#39;</span> <span class="ow">in</span> <span class="n">curve</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">rv</span> <span class="ow">is</span> <span class="bp">None</span> <span class="p">:</span>
            <span class="n">rv</span> <span class="o">=</span> <span class="mf">4.05</span>
        <span class="n">corr</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">if</span> <span class="n">curve</span> <span class="o">==</span> <span class="s1">&#39;cal00*&#39;</span><span class="p">:</span>
            <span class="n">corr</span> <span class="o">=</span> <span class="mf">0.44</span>
        <span class="k">return</span> <span class="n">cal00_ke</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="n">rv</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">ab</span><span class="o">-</span><span class="n">av</span><span class="p">)</span><span class="o">*</span><span class="n">corr</span>
        
    <span class="k">elif</span> <span class="n">curve</span> <span class="o">==</span><span class="s1">&#39;ccm89&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">rv</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">rv</span> <span class="o">=</span> <span class="mf">3.1</span>
        <span class="k">return</span> <span class="n">ccm89_alav</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="n">rv</span><span class="p">)</span><span class="o">*</span><span class="n">av</span>      </div>
<span class="c1"># ---------------------------------------------------------------------------------------- </span>

<div class="viewcode-block" id="galactic_red"><a class="viewcode-back" href="../modules/brutus_red.html#brutus_red.galactic_red">[docs]</a><span class="k">def</span> <span class="nf">galactic_red</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span> <span class="n">ab</span><span class="p">,</span> <span class="n">av</span><span class="p">,</span> <span class="n">curve</span><span class="o">=</span><span class="s1">&#39;f99&#39;</span><span class="p">,</span> <span class="n">rv</span> <span class="o">=</span> <span class="mf">3.1</span><span class="p">,</span> <span class="n">rva</span> <span class="o">=</span> <span class="mf">4.3</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Calculate the galactic extinction for a given sight-line, using Ab and Av.</span>
<span class="sd">    </span>
<span class="sd">    :Args:</span>
<span class="sd">        lams: 1-D numpy array of float</span>
<span class="sd">             The values at which to evaluate the attenuation/extinction.</span>
<span class="sd">        ab: float</span>
<span class="sd">            The extinction in B (e.g. according to NED).</span>
<span class="sd">        av: float</span>
<span class="sd">            The extinction in V (e.g. according to NED) .</span>
<span class="sd">        curve: string [default: &#39;f99&#39;]</span>
<span class="sd">               Which extinction/attenuation curve to use.</span>
<span class="sd">        rv: float</span>
<span class="sd">            Rv value.</span>
<span class="sd">        rva: float [default: 4.5]</span>
<span class="sd">             The value of Rva, if using curve=&#39;fd05&#39;.</span>
<span class="sd">         </span>
<span class="sd">    :Returns:</span>
<span class="sd">        out: 1-dNumpy array</span>
<span class="sd">             The ratio of Flux_(unreddened)/ Flux_(observed).</span>
<span class="sd">    :Notes:</span>
<span class="sd">        To follow NED, set curve=&#39;f99&#39;, and rv = 3.1. The default </span>
<span class="sd">        value of Rv will depend on the curve used (if not specified). rv=3.1 for &#39;f99&#39;, </span>
<span class="sd">        rv=3.08 for &#39;fd05&#39;, rv=4.05 for &#39;cal00&#39; and &#39;cal00*&#39;, and rv=3.1 for &#39;ccm89&#39;. </span>
<span class="sd">        &#39;cal00*&#39; includes a 0.44 correction factor to derive the stellar extinction.</span>
<span class="sd">        </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">tau</span> <span class="o">=</span> <span class="n">alam</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="n">ab</span><span class="p">,</span><span class="n">av</span><span class="p">,</span><span class="n">curve</span><span class="o">=</span><span class="n">curve</span><span class="p">,</span><span class="n">rv</span><span class="o">=</span><span class="n">rv</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">2.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">e</span><span class="p">))</span><span class="o">**-</span><span class="mi">1</span>
          
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span></div>
<span class="c1"># ---------------------------------------------------------------------------------------- </span>

<div class="viewcode-block" id="extragalactic_red"><a class="viewcode-back" href="../modules/brutus_red.html#brutus_red.extragalactic_red">[docs]</a><span class="k">def</span> <span class="nf">extragalactic_red</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span> <span class="n">hahb</span><span class="p">,</span> <span class="n">hahb_0</span><span class="p">,</span> <span class="n">curve</span> <span class="o">=</span> <span class="s1">&#39;fd05&#39;</span><span class="p">,</span> <span class="n">rv</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">rva</span><span class="o">=</span><span class="mf">4.3</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Calculate the extragalactic attenuation (based on Halpha/Hbeta).</span>
<span class="sd">    </span>
<span class="sd">    :Args:</span>
<span class="sd">        lam: float</span>
<span class="sd">              The wavelength at which to evaluate the attenuation/extinction.</span>
<span class="sd">        hahb: float or numpy array</span>
<span class="sd">              The observed Halpha/Hbeta flux ratio. Can be a 2-D map.</span>
<span class="sd">        hahb_0: float</span>
<span class="sd">                The reference theoretical unreddened Halpha/Hbeta flux ratio.</span>
<span class="sd">        curve: string [default: &#39;fd05&#39;]</span>
<span class="sd">               Which extinction/attenuation curve to use.</span>
<span class="sd">        rv: float [default: None]</span>
<span class="sd">            Rv value.</span>
<span class="sd">        rva: float [default: 4.3]</span>
<span class="sd">             The value of Rva, if using curve=&#39;fd05&#39;. </span>
<span class="sd">    :Returns:</span>
<span class="sd">        out: 1-D numpy array</span>
<span class="sd">             The ratio of Flux_(unattenuated)/ Flux_(attenuated)</span>
<span class="sd">    :Notes:</span>
<span class="sd">        See also Vogt+ (2013), Appendix A. By default, Rv = 3.08 and Rva = 4.3, which </span>
<span class="sd">        gives a curve vey close to that of Calzetti (2000) below the 2000 Ansgtroem bump. </span>
<span class="sd">        Supported curves are &#39;fd05&#39;, &#39;f99&#39;,&#39;ccm89&#39;,&#39;cal00&#39; and &#39;cal00*&#39;.&#39;cal00*&#39; includes </span>
<span class="sd">        a 0.44 correction factor to derive the stellar extinction.</span>
<span class="sd">        </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">curve</span> <span class="o">==</span> <span class="s1">&#39;fd05&#39;</span> <span class="p">:</span>
        <span class="n">elvebv</span> <span class="o">=</span> <span class="n">fd05_elvebv</span><span class="p">(</span><span class="n">lam</span><span class="p">)</span>
        <span class="n">ehavebv</span> <span class="o">=</span> <span class="n">fd05_elvebv</span><span class="p">(</span><span class="n">ha</span><span class="p">)</span>	
        <span class="n">ehbvebv</span> <span class="o">=</span> <span class="n">fd05_elvebv</span><span class="p">(</span><span class="n">hb</span><span class="p">)</span> 
        <span class="n">out</span> <span class="o">=</span> <span class="p">(</span><span class="n">hahb</span><span class="o">/</span><span class="n">hahb_0</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">elvebv</span> <span class="o">+</span> <span class="n">rva</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">ehavebv</span><span class="o">-</span><span class="n">ehbvebv</span><span class="p">))</span>  
        <span class="k">return</span> <span class="n">out</span>
    <span class="k">if</span> <span class="n">curve</span> <span class="o">==</span> <span class="s1">&#39;ccm89&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">rv</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">rv</span> <span class="o">=</span> <span class="mf">3.1</span>
        <span class="n">alav</span> <span class="o">=</span> <span class="n">ccm89_alav</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span> <span class="n">rv</span><span class="p">)</span>
        <span class="n">aHaav</span> <span class="o">=</span> <span class="n">ccm89_alav</span><span class="p">(</span><span class="n">ha</span><span class="p">,</span> <span class="n">rv</span><span class="p">)</span>
        <span class="n">aHbav</span> <span class="o">=</span> <span class="n">ccm89_alav</span><span class="p">(</span><span class="n">hb</span><span class="p">,</span> <span class="n">rv</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">hahb</span><span class="o">/</span><span class="n">hahb_0</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">alav</span><span class="o">/</span><span class="p">(</span><span class="n">aHaav</span><span class="o">-</span><span class="n">aHbav</span><span class="p">))</span>
        
    <span class="k">elif</span> <span class="s1">&#39;cal00&#39;</span> <span class="ow">in</span> <span class="n">curve</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">rv</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">rv</span><span class="o">=</span><span class="mf">4.05</span>
        <span class="n">ke</span> <span class="o">=</span> <span class="n">cal00_ke</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span><span class="n">rv</span><span class="p">)</span>
        <span class="n">keHa</span> <span class="o">=</span> <span class="n">cal00_ke</span><span class="p">(</span><span class="n">ha</span><span class="p">,</span><span class="n">rv</span><span class="p">)</span>
        <span class="n">keHb</span> <span class="o">=</span> <span class="n">cal00_ke</span><span class="p">(</span><span class="n">hb</span><span class="p">,</span><span class="n">rv</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">curve</span> <span class="o">==</span> <span class="s1">&#39;cal00*&#39;</span><span class="p">:</span>
            <span class="n">ke</span> <span class="o">*=</span><span class="mf">0.44</span>
            <span class="n">keHa</span> <span class="o">*=</span> <span class="mf">0.44</span>
            <span class="n">keHb</span> <span class="o">*=</span> <span class="mf">0.44</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">hahb</span><span class="o">/</span><span class="n">hahb_0</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">ke</span><span class="o">/</span><span class="p">(</span><span class="n">keHa</span><span class="o">-</span><span class="n">keHb</span><span class="p">))</span>
        
    <span class="k">elif</span> <span class="n">curve</span> <span class="o">==</span> <span class="s1">&#39;f99&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">rv</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">rv</span><span class="o">=</span><span class="mf">3.1</span>
        <span class="n">alebv</span> <span class="o">=</span> <span class="n">f99_alebv</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span><span class="n">rv</span><span class="p">)</span>
        <span class="n">aHaebv</span> <span class="o">=</span> <span class="n">f99_alebv</span><span class="p">(</span><span class="n">ha</span><span class="p">,</span><span class="n">rv</span><span class="p">)</span>
        <span class="n">aHbebv</span> <span class="o">=</span> <span class="n">f99_alebv</span><span class="p">(</span><span class="n">hb</span><span class="p">,</span><span class="n">rv</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">hahb</span><span class="o">/</span><span class="n">hahb_0</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">alebv</span><span class="o">/</span><span class="p">(</span><span class="n">aHaebv</span><span class="o">-</span><span class="n">aHbebv</span><span class="p">))</span></div>
<span class="c1"># ----------------------------------------------------------------------------------------         </span>

<div class="viewcode-block" id="hahb_to_av"><a class="viewcode-back" href="../modules/brutus_red.html#brutus_red.hahb_to_av">[docs]</a><span class="k">def</span> <span class="nf">hahb_to_av</span><span class="p">(</span><span class="n">hahb</span><span class="p">,</span><span class="n">hahb_0</span><span class="p">,</span> <span class="n">curve</span> <span class="o">=</span> <span class="s1">&#39;fd05&#39;</span><span class="p">,</span> <span class="n">rv</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">rva</span><span class="o">=</span><span class="mf">4.3</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;A function to get the reddening in Av mag, from Ha/Hb ratio.</span>
<span class="sd">    </span>
<span class="sd">    :Args: </span>
<span class="sd">        ha_hb: 1-D numpy array</span>
<span class="sd">               The flux ratio of Halpha to Hbeta (NOT the log!)</span>
<span class="sd">        ha_hb_0: float</span>
<span class="sd">                 The theoretical value of Halpha/Hbeta. (2.86 for SB, more for AGNs)</span>
<span class="sd">        curve: string [default: &#39;fd05&#39;]</span>
<span class="sd">               Which reddeing law to use ?</span>
<span class="sd">        rv: float [default: None]</span>
<span class="sd">            The value of Rv to use. None for the default.</span>
<span class="sd">    </span>
<span class="sd">    :Returns: </span>
<span class="sd">        out: 1-D numpy array</span>
<span class="sd">             The corrseponding values of Av.</span>
<span class="sd">    :Notes:</span>
<span class="sd">        See also Vogt+ (2013), Appendix A. By default, Rv = 3.08 and Rva = 4.3, which </span>
<span class="sd">        gives a curve vey close to that of Calzetti (2000) below the 2000 Ansgtroem bump.</span>
<span class="sd">        </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">curve</span> <span class="o">==</span> <span class="s1">&#39;fd05&#39;</span> <span class="p">:</span>
        <span class="n">ehavebv</span> <span class="o">=</span> <span class="n">fd05_elvebv</span><span class="p">(</span><span class="n">ha</span><span class="p">)</span>	
        <span class="n">ehbvebv</span> <span class="o">=</span> <span class="n">fd05_elvebv</span><span class="p">(</span><span class="n">hb</span><span class="p">)</span> 
        <span class="n">out</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">hahb</span><span class="o">/</span><span class="n">hahb_0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">rva</span><span class="o">/</span><span class="p">(</span><span class="n">ehavebv</span><span class="o">-</span><span class="n">ehbvebv</span><span class="p">))</span>  
        <span class="k">return</span> <span class="n">out</span>
    <span class="k">if</span> <span class="n">curve</span> <span class="o">==</span> <span class="s1">&#39;ccm89&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">rv</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">rv</span> <span class="o">=</span> <span class="mf">3.1</span>
        <span class="n">aHaav</span> <span class="o">=</span> <span class="n">ccm89_alav</span><span class="p">(</span><span class="n">ha</span><span class="p">,</span> <span class="n">rv</span><span class="p">)</span>
        <span class="n">aHbav</span> <span class="o">=</span> <span class="n">ccm89_alav</span><span class="p">(</span><span class="n">hb</span><span class="p">,</span> <span class="n">rv</span><span class="p">)</span>
        <span class="k">return</span> <span class="o">-</span><span class="mf">2.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">hahb</span><span class="o">/</span><span class="n">hahb_0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="n">aHaav</span><span class="o">-</span><span class="n">aHbav</span><span class="p">))</span>
        
    <span class="k">elif</span> <span class="n">curve</span> <span class="o">==</span> <span class="s1">&#39;cal00&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">rv</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">rv</span><span class="o">=</span><span class="mf">4.05</span>
        <span class="n">keHa</span> <span class="o">=</span> <span class="n">cal00_ke</span><span class="p">(</span><span class="n">ha</span><span class="p">,</span><span class="n">rv</span><span class="p">)</span>
        <span class="n">keHb</span> <span class="o">=</span> <span class="n">cal00_ke</span><span class="p">(</span><span class="n">hb</span><span class="p">,</span><span class="n">rv</span><span class="p">)</span>
        <span class="k">return</span> <span class="o">-</span><span class="mf">2.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">hahb</span><span class="o">/</span><span class="n">hahb_0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">rv</span><span class="o">/</span><span class="p">(</span><span class="n">keHa</span><span class="o">-</span><span class="n">keHb</span><span class="p">))</span>
        
    <span class="k">elif</span> <span class="n">curve</span> <span class="o">==</span> <span class="s1">&#39;f99&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">rv</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">rv</span><span class="o">=</span><span class="mf">3.1</span>
        <span class="n">aHaebv</span> <span class="o">=</span> <span class="n">f99_alebv</span><span class="p">(</span><span class="n">ha</span><span class="p">,</span><span class="n">rv</span><span class="p">)</span>
        <span class="n">aHbebv</span> <span class="o">=</span> <span class="n">f99_alebv</span><span class="p">(</span><span class="n">hb</span><span class="p">,</span><span class="n">rv</span><span class="p">)</span>
        <span class="k">return</span> <span class="o">-</span><span class="mf">2.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">hahb</span><span class="o">/</span><span class="n">hahb_0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">rv</span><span class="o">/</span><span class="p">(</span><span class="n">aHaebv</span><span class="o">-</span><span class="n">aHbebv</span><span class="p">))</span></div>
<span class="c1"># ---------------------------------------------------------------------------------------- </span>

<div class="viewcode-block" id="check"><a class="viewcode-back" href="../modules/brutus_red.html#brutus_red.check">[docs]</a><span class="k">def</span> <span class="nf">check</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Make some quick plots to test the reddening functions of brutus, by comparing with</span>
<span class="sd">    the original papers. And make sure I did not mess things up ...</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="c1"># 1) Check Cardelli89 and Fitzpatrick99: reproduce Fig. 7 of Fitzpatrick99    </span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">,</span><span class="mf">8.75</span><span class="p">,</span><span class="mf">0.001</span><span class="p">)</span>
    <span class="n">lams</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="o">*</span><span class="mf">1.e4</span>
     
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="mi">97</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">97</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.05</span> <span class="p">)</span>
     
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
     
    <span class="n">ls</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;m&#39;</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">]</span>
     
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">r</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mf">2.3</span><span class="p">,</span><span class="mf">3.1</span><span class="p">,</span><span class="mf">4.0</span><span class="p">,</span><span class="mf">5.5</span><span class="p">]):</span>
        <span class="n">f99_curve</span> <span class="o">=</span> <span class="n">f99_alebv</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="n">r</span><span class="p">)</span> <span class="o">-</span> <span class="n">r</span>
        <span class="n">ccm89_curve</span> <span class="o">=</span> <span class="p">(</span><span class="n">ccm89_alav</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="n">r</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="p">)</span> <span class="o">-</span><span class="n">r</span>
        
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">f99_curve</span><span class="p">,</span><span class="n">ls</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">r&#39;R$_V$ = &#39;</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">str</span><span class="p">(</span><span class="n">r</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">ccm89_curve</span><span class="p">,</span><span class="s1">&#39;k--&#39;</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">r&#39;1/$\lambda$ [$\mu$m$^{-1}$]&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">r&#39;E($\lambda$-V)/E(B-V)&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="s1">&#39;Fitzpatrick (1999) - Fig. 7; F99 (-) vs CCM89 (- -)&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">13</span><span class="p">])</span>
    <span class="c1"># Add the MUSE range because I can</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">4750.</span><span class="o">/</span><span class="mf">1e4</span><span class="p">),</span><span class="n">ymax</span><span class="o">=</span><span class="mf">0.65</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">9350.</span><span class="o">/</span><span class="mf">1e4</span><span class="p">),</span><span class="n">ymax</span><span class="o">=</span><span class="mf">0.65</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.7</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="s1">r&#39;MUSE range (4750\AA $\rightarrow$ 9350\AA)&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="c1"># --------------------------------------------------------------------------</span>
    <span class="c1"># 2) Compare with Fischera &amp; Dopita 2005  </span>
    
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">,</span><span class="mf">7.5</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="n">lams</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="o">*</span><span class="mf">1.e4</span>
     
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="mi">98</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">98</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],</span> <span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.05</span> <span class="p">)</span>
    
    <span class="n">r</span> <span class="o">=</span> <span class="mf">3.1</span>
    <span class="n">f99_curve</span> <span class="o">=</span> <span class="n">f99_alebv</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="n">r</span><span class="p">)</span> <span class="o">-</span> <span class="n">r</span>
    <span class="n">ccm89_curve</span> <span class="o">=</span> <span class="p">(</span><span class="n">ccm89_alav</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="n">r</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="p">)</span> <span class="o">-</span><span class="n">r</span>
    <span class="n">cal00_curve</span> <span class="o">=</span> <span class="n">cal00_ke</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="mf">4.05</span><span class="p">)</span> <span class="o">-</span> <span class="mf">4.05</span>   
    <span class="n">fd05_curve</span> <span class="o">=</span> <span class="n">fd05_elvebv</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="n">rv</span><span class="o">=</span><span class="mf">3.08</span><span class="p">,</span><span class="n">rva</span><span class="o">=</span><span class="mf">4.3</span><span class="p">)</span>
    
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">f99_curve</span><span class="p">,</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">r&#39;F99, R$_V$=&#39;</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">str</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">ccm89_curve</span><span class="p">,</span><span class="s1">&#39;g-&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">r&#39;CCM89, R$_V$=&#39;</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">str</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">cal00_curve</span><span class="p">,</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">r&#39;Cal00, R$_V$=4.05&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">fd05_curve</span><span class="p">,</span><span class="s1">&#39;k--&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;FD05,R$_V$=3.08, R$_V^{A}$=4.3&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">r&#39;E($\lambda$-V)/E(B-V)&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">4.5</span><span class="p">])</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">4750.</span><span class="o">/</span><span class="mf">1e4</span><span class="p">),</span><span class="n">ymax</span><span class="o">=</span><span class="mf">0.65</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">9350.</span><span class="o">/</span><span class="mf">1e4</span><span class="p">),</span><span class="n">ymax</span><span class="o">=</span><span class="mf">0.65</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.7</span><span class="p">,</span><span class="mf">2.5</span><span class="p">,</span><span class="s1">r&#39;MUSE range (4750\AA $\rightarrow$ 9350\AA)&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
    
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.4</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">f99_curve</span><span class="o">-</span><span class="n">fd05_curve</span><span class="p">,</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">r&#39;F99, R$_V$=&#39;</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">str</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">ccm89_curve</span><span class="o">-</span><span class="n">fd05_curve</span><span class="p">,</span><span class="s1">&#39;g-&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">r&#39;CCM89, R$_V$=&#39;</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">str</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">cal00_curve</span><span class="o">-</span><span class="n">fd05_curve</span><span class="p">,</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">r&#39;Cal00, R$_V$=&#39;</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">str</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>    
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">r&#39;$\Delta$E($\lambda$-V)/E(B-V)&#39;</span><span class="p">)</span>
    <span class="c1">#ax2.legend(loc=&#39;lower right&#39;)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">4.5</span><span class="p">])</span>
    <span class="c1">#ax1.ylim([-5,5])</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">r&#39;1/$\lambda$ [$\mu$m$^{-1}$]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">4750.</span><span class="o">/</span><span class="mf">1e4</span><span class="p">),</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">9350.</span><span class="o">/</span><span class="mf">1e4</span><span class="p">),</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
       
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="c1"># --------------------------------------------------------------------------</span>
    <span class="c1"># 3) Reproduce Fig.1 of Calzetti (2001) </span>
    
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">,</span><span class="mf">7.5</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>
    <span class="n">lams</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="o">*</span><span class="mf">1.e4</span>
     
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">99</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.05</span> <span class="p">)</span>
    
    <span class="n">f99_2</span> <span class="o">=</span> <span class="n">f99_alebv</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="mf">2.0</span><span class="p">)</span>
    <span class="n">f99_31</span> <span class="o">=</span> <span class="n">f99_alebv</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="mf">3.1</span><span class="p">)</span>
    <span class="n">f99_5</span> <span class="o">=</span> <span class="n">f99_alebv</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="mf">5.0</span><span class="p">)</span>
    <span class="n">ccm89_2</span> <span class="o">=</span> <span class="n">ccm89_alav</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="mf">2.0</span><span class="p">)</span><span class="o">*</span><span class="mf">2.0</span>
    <span class="n">ccm89_31</span> <span class="o">=</span> <span class="n">ccm89_alav</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="mf">3.1</span><span class="p">)</span><span class="o">*</span><span class="mf">3.1</span>
    <span class="n">ccm89_5</span> <span class="o">=</span> <span class="n">ccm89_alav</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="mf">5.0</span><span class="p">)</span><span class="o">*</span><span class="mf">5.0</span>
    <span class="c1">#ccm89_curve = (ccm89_alav(lams,r)*r) -r</span>
    <span class="n">cal00_curve</span> <span class="o">=</span> <span class="n">cal00_ke</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="mf">4.05</span><span class="p">)</span>   
    <span class="n">fd05_curve</span> <span class="o">=</span> <span class="n">fd05_elvebv</span><span class="p">(</span><span class="n">lams</span><span class="p">,</span><span class="n">rv</span><span class="o">=</span><span class="mf">3.08</span><span class="p">,</span><span class="n">rva</span><span class="o">=</span><span class="mf">4.3</span><span class="p">)</span><span class="o">+</span><span class="mf">4.3</span>
    
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">lams</span><span class="o">/</span><span class="mf">1.e4</span><span class="p">),</span><span class="n">f99_2</span><span class="p">,</span><span class="s1">&#39;g:&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">r&#39;F99, R$_V$=2.0&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">lams</span><span class="o">/</span><span class="mf">1.e4</span><span class="p">),</span><span class="n">f99_31</span><span class="p">,</span><span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">r&#39;F99, R$_V$=3.1&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">lams</span><span class="o">/</span><span class="mf">1.e4</span><span class="p">),</span><span class="n">f99_5</span><span class="p">,</span><span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">r&#39;F99, R$_V$=5.0&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">lams</span><span class="o">/</span><span class="mf">1.e4</span><span class="p">),</span><span class="n">ccm89_2</span><span class="p">,</span><span class="s1">&#39;r:&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">r&#39;CCM89, R$_V$=2.0&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">lams</span><span class="o">/</span><span class="mf">1.e4</span><span class="p">),</span><span class="n">ccm89_31</span><span class="p">,</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">r&#39;CCM89, R$_V$=3.1&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">lams</span><span class="o">/</span><span class="mf">1.e4</span><span class="p">),</span><span class="n">ccm89_5</span><span class="p">,</span><span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">r&#39;CCM89, R$_V$=5.0&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">lams</span><span class="o">/</span><span class="mf">1.e4</span><span class="p">),</span><span class="n">cal00_curve</span><span class="p">,</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">r&#39;Cal00, R$_V$=4.05&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">lams</span><span class="o">/</span><span class="mf">1.e4</span><span class="p">),</span><span class="n">fd05_curve</span><span class="p">,</span><span class="s1">&#39;k--&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;FD05,R$_V$=3.08, R$_{V}^{A}$=4.3&#39;</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">r&#39;A$_\lambda$/E(B-V)&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">r&#39;log[$\lambda$($\mu$m)]&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.3</span><span class="p">])</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">15</span><span class="p">])</span>
    
    <span class="c1"># Add the MUSE range because I can</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mf">4750.</span><span class="o">/</span><span class="mf">1e4</span><span class="p">),</span><span class="n">ymax</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mf">9350.</span><span class="o">/</span><span class="mf">1e4</span><span class="p">),</span><span class="n">ymax</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">0.15</span><span class="p">,</span><span class="mf">8.1</span><span class="p">,</span><span class="s1">r&#39;MUSE range (4750\AA $\rightarrow$ 9350\AA)&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
    
       
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>
<span class="c1"># ----------------------------------------------------------------------------------------</span>


</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Frédéric P.A. Vogt.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.3.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>